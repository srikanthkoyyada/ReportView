<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<title>Reports</title>
<link rel="stylesheet" href="webjars/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" href="webjars/bootstrap-datepicker/1.6.1/css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="webjars/jquery-ui/1.12.1/jquery-ui.min.css">
<link rel="stylesheet" href="webjars/fontawesome/4.7.0/css/font-awesome.min.css">
<style type="text/css">
 
.table-responsive {
    max-height: 450px;
    overflow: scroll;
} 
 
</style>

</head> 


<body>
	<div class="container">
		<div class="row">

			<div class="col-md-12">

				<div class="panel panel-success panel-table">
					<div class="panel-heading">
						<div class="row">
							<div class="col col-xs-12">
								<h3 class="panel-title">Daily Transaction Journal</h3>
								<hr>
							</div>
							<div class="col col-md-12">
							 <label class="control-label col-md-1" for="level">Level*</label>
						      <div class="col-md-3">          
						        <select class="form-control" name="level" id="level">
								<option value="0">ALL</option>
								</select>
						      </div>
						       <label class="control-label col-md-2" for="trans type">Transaction Type*</label>
						      <div class="col-md-3">          
						       <select class="form-control" name="trans_type" id="trans_type">
								<option value="ALL">ALL</option>
								</select>
						      </div>
						      
						      </div>
						      <div class="col col-md-12" style="margin-top: 10px;">
							 <label class="control-label col-md-1" for="sort column">Sort By Column</label>
						      <div class="col-md-3">          
						        <select class="form-control" name="sort_column" id="sort_column">
						        <option value="0" disabled="disabled" selected="selected">-- Select Column --</option>
								<option value="getOne">Store Nbr</option>
								<option value="getTwo">Drawer Nbr</option>
								<option value="getThree">Date and Time</option>
								<option value="getFive">Customer Nbr</option>
								<option value="getFour">Customer Name</option>
								<option value="getSix">Loan Nbr</option>
								<option value="getSeven">Tran Nbr</option>
								<option value="getNine">Issuing Check Amt</option>
								<option value="getEleven">Tran Amt</option>
								<option value="getTwelve">Principal Amt</option>
								<option value="getThirteen">Fee Amt</option>
								<option value="getFourteen">Interest Amt</option>
								<option value="getFifteen">NSF Fee Amt</option>
								<option value="getSixteen">Orig Fee Amt</option>
								<option value="getThirtyNine">Other Fee Amt</option>
								<option value="getThirtyFour">Waive Fee Amt</option>
								<option value="getFortyFour">Lien Fee Amt</option>
								<option value="getFortyFive">Waive Lien Fee Amt</option>
								<option value="getFortySix">Repo Fee Amt</option>
								<option value="getFortySeven">Sale Fee Amt</option>
								<option value="getTwentyOne">Cash Amt</option>
								<option value="getTwentyTwo">Check Amt</option>
								<option value="getTwentyThree">CC/MO Amt</option>
								<option value="getTwentyFour">Debit Card Amt</option>
								<option value="getFortyOne	">ACH Amt</option>
								<option value="getSeventyEight">Prepaid Card</option>
								<option value="getseventysix">RCC amt</option>
								<option value="getThirtyThree">Emp Nbr</option>
								<option value="getTwentyFive">Emp Name</option>
								<option value="getTwentySix">Loan Type</option>
								<option value="getTwentySeven">Void Flag</option>
								<option value="getThirtySix">Collateral Type</option>
								<option value="getThirtyOne">Orig Store Nbr</option>
								<option value="getFortyNine">Payment Plan Fee</option>
								<option value="getSeventyNine">MHC Fee Amt</option>
								</select>
						      </div>
						       <label class="control-label col-md-2" for="sort order">Sort Order</label>
						      <div class="col-md-3">          
						       <select class="form-control" name="sort_order" id="sort_order">
						       <option value=""  disabled="disabled" selected="selected">-- Select Order --</option>
								<option value="ASC">Ascending</option>
								<option value="DESC">Descending</option>
								</select>
						      </div>
						      
						      </div>
						     <div class="col col-md-12" style="margin-top: 10px;">
						      <label class="control-label col-md-2" for="begin date">Begin Date</label>
						      <div class="col-md-3">          
						       <input type="text" name="begin_date" class="form-control date" id="begin_date" required="required">
						      </div>
						      </div>
						      <div class="col col-md-12" style="margin-top: 10px;">
						       <label class="control-label col-md-2" for="end type">End Date</label>
						      <div class="col-md-3">          
						       <input type="text" name="end_date" class="form-control date" id="end_date" required="required">
						      </div>
							  <button type="button" class="btn btn-sm btn-default" id="report_preview" data-loading-text="Please wait..">Preview</button>
							  <button type="button" class="btn btn-sm btn-default export_report" id="report_csv" data-loading-text="Downloading..">Export TO Excel</button>
								  <button type ="button" class="btn btn-sm btn-default" id="print_button" data-loading-text="Fetching Data For Print..">Print</button>
							</div>
							<div class="col-md-5 col-md-offset-4 alert alert-success" id="print_loader_div" style="display: none;z-index:9999">
			<span class="fa fa-spinner fa-spin" style="font-size: 24px;" ></span>
			<span id="print_loader_text"></span>
			</div>
						</div>
					</div>
					<div class="panel-body" id="panel_body"  style="display: none;">
						
					
						<div class=" table-responsive">
						
						<table
							class="table table-striped table-bordered table-list table-condensed" id="table_data">
							<thead>
								<tr bgcolor="#708090">
								   <th class="col-xs-3">Store Nbr</th>
								   <th class="col-xs-3">Drawer Nbr</th>
								   <th class="col-xs-3">Date and Time</th>
								   <th class="col-xs-3">Customer Nbr</th>
								   <th class="col-xs-3">Customer Name</th>
								   <th class="col-xs-3">Loan Nbr</th>
								   <th class="col-xs-3">Tran Nbr</th>
								   <th class="col-xs-3">Check Nbr</td>
								   <th class="col-xs-3">Issuing Check Amt</th>
								   <th class="col-xs-3">Tran Amt</th>
								   <th class="col-xs-3">Principal Amt</th>
								   <th class="col-xs-3">Fee Amt</th>
								   <th class="col-xs-3">Interest Amt</th>
								   <th class="col-xs-3">NSF Fee Amt</th>
								   <th class="col-xs-3">Orig Fee Amt</th>
								   <th class="col-xs-3">Late Fee Amt</th>
								   <th class="col-xs-3">Other Fee Amt</th>
								   <th class="col-xs-3">Waive Fee Amt</th>
								   <th class="col-xs-3">Lien Fee Amt</th>
								   <th class="col-xs-3">Waive Lien Fee Amt</th>
								   <th class="col-xs-3">Repo Fee Amt</th>
								   <th class="col-xs-3">Sale Fee Amt</th>
								   <th class="col-xs-3">Cash Amt</th>
								   <th class="col-xs-3">Check Amt</th>
								   <th class="col-xs-3">CC/MO Amt</th>
								   <th class="col-xs-3">Debit Card Amt</th>
								   <th class="col-xs-3">ACH Amt</th>
								   <th class="col-xs-3">Prepaid Card</th>
								   <th class="col-xs-3">RCC amt</th>
								   <th class="col-xs-3">Emp Nbr</th>
								   <th class="col-xs-3">Emp Name</th>
								   <th class="col-xs-3">Loan Type</th>
								   <th class="col-xs-3">Void Flag</th>
								   <th class="col-xs-3">Collateral Type</th>
								    <th class="col-xs-3">Orig Store Nbr</th>
								   <th class="col-xs-3">Payment Plan Fee</th>
								   <th class="col-xs-3">MHC Fee Amt</th>
								</tr>
							</thead>

							<tbody id="trans_body">

							</tbody>
						</table>
						</div>
					</div>
					<div class="panel-footer" id="panel_footer" style="display: none;">
						<div class="row">

							<div class="col col-xs-8">
							<div style="float: right;">
									<ul class="pagination pagination-sm"></ul>
								</div></div>
						</div>
					</div>
				</div>
				
			</div>

		</div>
	</div>
	<div class="row">
	<div id="myModal" class="modal fade">
  	<div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Print Report Details</h4>
      </div>
      <div class="modal-body" style="max-height: 350px;overflow: auto;width: auto;" id="print_column_list">
        <p>Please select the columns to print.</p>
        
            <div class="col-md-3">
       				  <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="STORE" checked="checked">Store Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="DRAWER_CODE" checked="checked">Drawer Nbr</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="DTTRANDATE" checked="checked">Date and Time</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CUSTNBR" checked="checked">Customer Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="NAME" checked="checked">Customer Name</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="LC_CODE" checked="checked">Loan Nbr</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="TRANSACTION_NUMBER" checked="checked">Tran Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="BO_CHECK_NUM" checked="checked">Check Nbr</label></div>
							 
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ISSUING_CHECK_AMOUNT" checked="checked">Issuing Check Amt</label></div>
							    
							      </div>
							   <div class="col-md-3">
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="TRAN_AMT" checked="checked">Tran Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="PRINCIPAL" checked="checked">Principal Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="FEES" checked="checked">Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="INTERESTFEE">Interest Amt</label></div>
							 
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="NSFAMT">NSF Fee Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ORIG_FEE">Orig Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="LATE_FEE_CHARGED">Late Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="OTHER_FEE">Other Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="WAIVED_FEE_AMT">Waive Fee Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="LIEN_FEE">Lien Fee Amt</label></div>
							     </div>
							   <div class="col-md-3">
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="WAIVE_LIEN_FEE">Waive Lien Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="REPO_FEE">Repo Fee Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="SALE_FEE">Sale Fee Amt</label></div>
							  
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CASHAMT">Cash Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CHECKAMT">Check Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CCMOAMT">CC/MO Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="DEBITCARDAMT">Debit Card Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ACH_AMT">ACH Amt</label></div>
							   <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="PREPAIDCARD_AMT">Prepaid Card</label></div>
							     </div>
							    <div class="col-md-3">
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="RCC_FEE">RCC amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="EMP_NUMBER">Emp Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="EMPNAME">Emp Name</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="TYPE">Loan Type</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="VOID_FLAG">Void Flag</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="COLLATERAL_TYPE">Collateral Type</label></div>
							      <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ORIG_STORE_NUMBER">Orig Store Nbr</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="PPF_FEE">Payment Plan Fee</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="MHC_FEE">MHC Fee Amt</label></div>
								</div>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" id="table_print_full">Print</button>
      </div>
    </div>

  </div>
</div>		
		</div>				
</body>
<object viewastext style="display:none"
    classid="clsid:5445be81-b796-11d2-b931-002018654e2e"
    codebase="/print/smsx.cab#Version=8,2,1,2">
        <param name="GUID" value="{370000ed-d40c-43d4-b3d3-f2e7d2eff47d}">
        <param name="Path" value="/print/sxlic.mlf">
        <param name="Revision" value="0">
</object>
 
<!-- MeadCo ScriptX -->
<object id="factory" viewastext style="display:none"
    classid="clsid:1663ed61-23eb-11d2-b92f-008048fdd814">
</object>
<script	type="text/javascript" src="webjars/jquery/2.2.4/jquery.min.js"></script>
<script	type="text/javascript" src="webjars/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script	type="text/javascript" src="webjars/bootstrap-datepicker/1.6.1/js/bootstrap-datepicker.min.js"></script>
<script src="/js/jquery.twbsPagination.js"></script>
<script src="/js/jstorage.min.js"></script>


<script type="text/javascript">

$(document).ready( function () {
	
	$('#begin_date').datepicker({ 
		changeMonth: true,
	    changeYear: true,
		format:'mm/dd/yyyy',
		endDate:new Date(),
		autoclose:true
		
	}).on('changeDate',function(selected){
		var minDate = new Date(selected.date);
		$('#end_date').datepicker('setStartDate', minDate);
	});
	$('#end_date').datepicker({
		changeMonth: true,
	    changeYear: true,
		format:'mm/dd/yyyy',
		endDate:new Date(),
		autoclose:true
	});
	
	

	function validateFilters(){
		if($('#begin_date').val().length ==0 || $('#end_date').val().length ==0)
		{
			alert('Please select date range to preview data');
			return false;
		}else
			{
			return true;
			}
	}
	$("#report_preview").click(function(){
		
		if(validateFilters()){
			//clear browser enabled storage for the first time when the user changes the filter input
			$.jStorage.flush();
			//load transactions into html table by using ajax call
		  loadTransactions(1);
			//show table 
		  $("#panel_body,#panel_footer").css('display','block');
		
		}
		  
	});
	function buildPagination(totlaPages){
		//destroys if any pagination is already added to DOM
		$('.pagination').twbsPagination('destroy');
		//create pagination by taking total pages as input and keeping 1000 records per page
 	$('.pagination').twbsPagination({
 		
		totalPages: totlaPages,
		// the current page that show on start
		startPage: 1,

		// maximum visible pages
		visiblePages: 5,

		initiateStartPageClick: false,

		// template for pagination links
		href: false,

		// variable name in href template for page number
		hrefVariable: '{{number}}',

		// Text labels
		first: 'first',
		prev: 'prev',
		next: 'next',
		last: 'last	',

		// carousel-style pagination
		loop: false,

		// callback function
		onPageClick: function (event, page) {
		
			
		  loadTransactions($("li[class='page active'] a").text());
		 
		},

		// pagination Classes
		paginationClass: 'pagination',
		nextClass: 'next',
		prevClass: 'prev',
		lastClass: 'last',
		firstClass: 'first',
		pageClass: 'page',
		activeClass: 'active',
		disabledClass: 'disabled'

		});
}
	
	//loads the filtered transactions by using a API service URL or from chache
	function loadTransactions(pageNumber) {
	      var tr;
	      var limit=1000;
	      var totalCountFlag='N';
	      var offset=(pageNumber*limit)-limit; 
	     
	      //check whether the requested transactions are available in jstorage cache or not
	      var cachedData=$.jStorage.get(pageNumber);
	       if(cachedData){
	    	   //if the cache is available then load from there
	    	  $('#trans_body').html('');
	    	  $('#trans_body').html(buildTableData(cachedData));
		  }else{
		  //if data not there in cache get from DB
		  //turn on total records count flag if the page number is 1 to get the total records from DB for pagination
			 // if(pageNumber==1)
				  totalCountFlag='N';
	      $.ajax({
	    	  	type:'POST',
				url:"http://localhost:8084/api-auth/report/dailyTrans/getTransJournal",
				data:JSON.stringify( {'level':$("#level").val(),
					  'transType':$("#trans_type").val(),
					  'beginDate':$("#begin_date").val(),
					  'endDate':$("#end_date").val(),
					  'limit':limit,
					  'offset':offset,
					  'totalCountFlag':totalCountFlag,
					  'sortOrder':$("#sort_order").val(),
					  'sortColumn':$("#sort_column").val()
					}),
				dataType:'json',
				contentType:'application/json',
				cache:false,
			    beforeSend:function(xhr){
			    	xhr.setRequestHeader ("Authorization", "Basic " + btoa('user' + ":" + 'password'));
			    	 $('#trans_body').html('');
			    	 $('#trans_body').html('<p>Loading data.Please wait..</p>');
			    	 //isDataLoading=true;
			    	$("#report_preview").button('loading');
			    },
			    success:function(response){
			    
			    	//store data in cache after getting from DB
			    	$.jStorage.set(pageNumber,response); 
			    	var totalRecords;
			    	 $('#trans_body').html('');
			    	 $('#trans_body').html(buildTableData(response));
			   	     totalRecords=response[0].v_count;
			    	
			   	if(pageNumber==1){
			   		
			   //	var totalPages=(Math.floor(totalRecords/1000))+(totalRecords%1000>0?1:0);
			   	buildPagination(10);
			   	}	
			    },
			    complete:function(){
			    	//isDataLoading=false;
			    	
			    		$("#report_preview").button('reset');
			    }
			});
		  }
	      
	}
	
	function buildTableData(data){
		var tableData;
	 	$.each(data, function(i,tran){
	   		
	 		tableData += "<tr>";
	   		tableData +="<td class='col-xs-3'>"+tran.store+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.drawer_code+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.dttrandate+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.custnbr+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.name+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.lc_code+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.transaction_number+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.bo_check_num+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.issuing_check_amount+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.tran_amt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.principal+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.fees+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.interestfee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.nsfamt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.orig_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.late_fee_charged+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.other_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.waived_fee_amt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.lien_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.waive_lien_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.repo_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.sale_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.cashamt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.checkamt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.ccmoamt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.debitcardamt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.ach_amt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.prepaidcard_amt+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.rcc_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.emp_number+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.empname+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.type+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.void_flag+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.collateral_type+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.orig_store_number+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.ppf_fee+ "</td>";
	   		tableData +="<td class='col-xs-3'>"+tran.mhc_fee+ "</td>";
	   		tableData +="</tr>";
           
            
	    	}); 
	 	return tableData;
	}
	
	// export data into excel sheet
	$('#report_csv').click(function(){
		if(validateFilters()){
			
			var link_href='http://localhost:8084/api-auth/report/dailyTrans/getTransJournalStream?startDate='+$("#begin_date").val()+'&endDate='+$("#end_date").val()+'&level='+$("#level").val()+'&transType='+$("#trans_type").val()+'&sortOrder='+$("#sort_order").val()+'&sortColumn='+$("#sort_column").val();
			$('body').append('<a id="link" href="'+link_href+'" target="_self">&nbsp;</a>');
			$('#link')[0].click();
			$('#report_csv').button('loading');
			//checkDownloadCookie();
			
			
		}
	});
	function getCookie(cname) {
		  var name = cname + "=";
		  var ca = document.cookie.split(';');
		  for(var i = 0; i < ca.length; i++) {
		    var c = ca[i];
		    while (c.charAt(0) == ' ') {
		      c = c.substring(1);
		    }
		    if (c.indexOf(name) == 0) {
		      return c.substring(name.length, c.length);
		    }
		  }
		  return "";
		}
	function checkDownloadCookie(){
		var cookieCheck=setInterval(function(){
			console.log('document.cookie::::'+document.cookie);
	        var waitcookie = getCookie('waitingCookie');

	        if(waitcookie != null && waitcookie!=''){
	           $('#report_csv').button('reset');
	           console.log(waitcookie);
	           clearInterval(cookieCheck);
	        } 

	    }, 3000);

	   
	}
	
	
	
	
	//print user requested data using scriptx
	 $('#table_print_full').click(function(){
		
				 
		var columns_checked=$('#print_column_list').find('input[type="checkbox"]:checked').length;
		if(columns_checked == 12){
			var selectedColumnValues=[];
			var selectedColumnNames=[];
			$.each($("input[name='column_name']:checked"), function(){
				selectedColumnNames.push($(this).parent('label').text());
				selectedColumnValues.push($(this).val());
            });
			var html="";
			 $.ajax({
		    	  	type:'POST',
					url:"http://localhost:8084/api-auth/report/dailyTrans/getTransJournal",
					data:JSON.stringify( {'level':$("#level").val(),
						  'transType':$("#trans_type").val(),
						  'beginDate':$("#begin_date").val(),
						  'endDate':$("#end_date").val(),
						  'limit':0,
						  'offset':0,
						  'sortOrder':$("#sort_order").val(),
						  'sortColumn':$("#sort_column").val()
						 
						}),
					dataType:'json',
					contentType:'application/json',
					cache:false,
				    beforeSend:function(xhr){
				    	xhr.setRequestHeader ("Authorization", "Basic " + btoa('user' + ":" + 'password'));
				    	 $('#print_button').button('loading');

				    },
				    success:function(response){
				    	console.log('data fetched to page..');
				    	html +="<html><head>";
				       // html +="<link rel=\"stylesheet\" href=\"webjars/bootstrap/3.3.6/css/bootstrap.min.css\">"
				        html +="<title>DTJ Report</title></head><body>";
						html +='<table>'
							 html +='<thead  bgcolor="#708090"><tr>'//border:1px solid #000;
						    	 for(var i=0;i<selectedColumnNames.length;i++){
						    		html+='<th>'+selectedColumnNames[i]+ '</th>';
								} 
								
								html+='</tr></thead>';
								html+='<tbody id="trans_body_full">';
							$.each(response, function(i,tran){
						   		var obj=tran;
						   		
								html+='<tr bgcolor="#DEF4F4">';
								 for(var x=0;x<selectedColumnValues.length;x++){
									 //console.console.log(selectedColumnValues[x].toLowerCase());
									html+='<td>'+tran[selectedColumnValues[x].toLowerCase()]+ '</td>';
								} 
						   		
						   		html+='</tr>';
							});
						html+='</tbody>';
						html+='</table>';
						 html +="</body></html>";
						
				    },
				    complete:function(){
				    	//printing
				    	
						
					 	 factory.printing.SetMarginMeasure(2) // set inches
				        factory.printing.header =""
				        factory.printing.footer = ""
				        factory.printing.leftMargin = 0.5
				        factory.printing.topMargin = 0.5
				        factory.printing.rightMargin =0.5
				        factory.printing.bottomMargin = 0.5
				        factory.printing.headerFooterFont = "font-size: 10px;"
				       factory.printing.PrintHTMLEx("html://" +html,false,printStatusUpdate,'Report printing job');
					 	 $('#print_button').button('reset');
					 	
						
				    }
				});

				
			return true;
		}else{
			alert("Please select at least 12 columns to print");
			return false;
		}
		
		
	}); 
	
	 function printStatusUpdate(status,statusData,myData){
		 $('#print_loader_div').css('display','block');
		 $("#print_button").attr("disabled", true);
		 switch ( status ) {
		    case 1:
		     $('#print_loader_text').html( myData + " has been queued");
		     
		      break;
		 
		    case 2:
		      $('#print_loader_text').html( myData + " has started");
		      break;                    
		 
		    case 3:
		      $('#print_loader_text').html( myData + " has started downloading: " + statusData);
		      break;   
		 
		    case 4:
		      $('#print_loader_text').html( myData + " has downloaded: " + statusData);
		      break;   
		 
		    case 5:
		      $('#print_loader_text').html( myData + " is in progress..");
		      break;   
		 
		    case 6:
		      $('#print_loader_text').html( myData + " has completed");
		      $('#print_loader_div').css('display','none');
		      $("#print_button").attr("disabled", false);
		      break;   
		 
		    case -1:
		      $('#print_loader_text').html( myData + " has an error: [" + statusData + "]");
		      
		      break;   
		 
		    case -2:
		      $('#print_loader_text').html( myData + " is being abandoned");
		      break;   
		 
		    default:
		      $('#print_loader_text').html( myData + " unknown status: " + status);
		      break;                   
		  }
	}
	//open modal window
	 $('#print_button').click(function(){
	 
	 	 if(validateFilters()){
	 	$('#myModal').modal('show');
	 	return true
	 }else{
	 	 return false;
	 }
	 });
	  $('#myModal').modal('hide');
});



</script>
</html>