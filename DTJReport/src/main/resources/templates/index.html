<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:td="http://www.thymeleaf.org">
<head>
<meta charset="utf-8" />
<title>Reports</title>
<link rel="stylesheet" href="webjars/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/qfund.css">
<link rel="stylesheet" href="/css/report_style.css">
<link rel="stylesheet" href="webjars/bootstrap-datepicker/1.6.1/css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="webjars/jquery-ui/1.12.1/jquery-ui.min.css">
<link rel="stylesheet" href="webjars/fontawesome/4.7.0/css/font-awesome.min.css">
<style type="text/css">

.table-responsive {
    max-height: 450px;
    overflow: scroll;
    max-width: 1250px;
} 
 .form-control {
    width: 75%;
    height: 25px;
    font-size: 12px;
    line-height: 1.5;
    color: #555;
    background-color: #fff;
 } 


 
</style>

</head> 


<body>
 
<table width="75%" border="0" cellspacing="3" cellpadding="0" class="Newborder-bouble" align="center" id="filter_options">
 <tr>
 <td>
 <table width="100%" border="0" cellspacing="0" cellpadding="0" class="Newborder-bouble" align="center">
 <tr>
 <td>

  <table width="100%" border="0" cellspacing="0" cellpadding="4">
  
<tr> 
      <td class="formHeading">Daily Transaction Journal</td>
	</tr>  
	<tr> 
  	<td >
		  <p><font face="Arial">&nbsp;&nbsp;&nbsp; <b><u>Filter Options</u></b></font></p>
  </td>
  </tr>
  <table border="0" width="800">
		  <tr> 
			   <td width="21"></td>
			   <td width="100"><b><font face="Arial">Level *</b></td>
			    <td width="150"> 
			   <select class="form-control" name="level" id="level">
								<option value="0">ALL</option>
								</select>
			   </td>
			    <td width="21"></td>
      <td width="100"><font face="Arial"><b>Transaction&nbsp;Type *</b></font></td>
      <td width="150"> 
             <select class="form-control" name="trans_type" id="trans_type">
								<option value="ALL">ALL</option>
								</select>
           </td>
			   
		</tr>
	<tr>
	<td>&nbsp;&nbsp;&nbsp;</td>
	</tr>
   <tr>  
     
            <td width="21"></td>
      <td width="100"><font face="Arial"><b>Sort Column</b></font></td>
      <td width="200"> 
              <select class="form-control" name="sort_column" id="sort_column">
						        <option value="0" disabled="disabled" selected="selected">-- Select Column --</option>
								<option value="getOne">Store Nbr</option>
								<option value="getTwo">Drawer Nbr</option>
								<option value="getThree">Date and Time</option>
								<option value="getFive">Customer Nbr</option>
								<option value="getFour">Customer Name</option>
								<option value="getSix">Loan Nbr</option>
								<option value="getSeven">Tran Nbr</option>
								<option value="getNine">Issuing Check Amt</option>
								<option value="getEleven">Tran Amt</option>
								<option value="getTwelve">Principal Amt</option>
								<option value="getThirteen">Fee Amt</option>
								<option value="getFourteen">Interest Amt</option>
								<option value="getFifteen">NSF Fee Amt</option>
								<option value="getSixteen">Orig Fee Amt</option>
								<option value="getThirtyNine">Other Fee Amt</option>
								<option value="getThirtyFour">Waive Fee Amt</option>
								<option value="getFortyFour">Lien Fee Amt</option>
								<option value="getFortyFive">Waive Lien Fee Amt</option>
								<option value="getFortySix">Repo Fee Amt</option>
								<option value="getFortySeven">Sale Fee Amt</option>
								<option value="getTwentyOne">Cash Amt</option>
								<option value="getTwentyTwo">Check Amt</option>
								<option value="getTwentyThree">CC/MO Amt</option>
								<option value="getTwentyFour">Debit Card Amt</option>
								<option value="getFortyOne	">ACH Amt</option>
								<option value="getSeventyEight">Prepaid Card</option>
								<option value="getseventysix">RCC amt</option>
								<option value="getThirtyThree">Emp Nbr</option>
								<option value="getTwentyFive">Emp Name</option>
								<option value="getTwentySix">Loan Type</option>
								<option value="getTwentySeven">Void Flag</option>
								<option value="getThirtySix">Collateral Type</option>
								<option value="getThirtyOne">Orig Store Nbr</option>
								<option value="getFortyNine">Payment Plan Fee</option>
								<option value="getSeventyNine">MHC Fee Amt</option>
								</select></td>
								 <td width="21"></td>
      <td width="100"><font face="Arial"><b>Sort Order</b></font></td>
      <td width="200"> 
             <select class="form-control" name="sort_order" id="sort_order">
						       <option value=""  disabled="disabled" selected="selected">-- Select Order --</option>
								<option value="ASC">Ascending</option>
								<option value="DESC">Descending</option>
								</select>
           </td>
    </tr>
     <tr>
	<td>&nbsp;&nbsp;&nbsp;</td>
	</tr>
     
 	<tr>
      <td width="21"></td>
      <td width="100"><b><font face="Arial">Begin  Date *</font></b></td>
      <td width="200"> <input type="text" name="begin_date" class="form-control date" id="begin_date" required="required"> </td> 
      <td width="21"></td>
      <td width="100"><b><font face="Arial">End  Date *</font></b></td>
      <td width="200"> <input type="text" name="end_date" class="form-control date" id="end_date" required="required"></td> 
    </tr>
	<tr>
	<td>&nbsp;&nbsp;&nbsp;</td>
	</tr>
  </table>
  </table>
  
  <p align="center" style="padding-top: 15px;">
  <b>
   <button type="button" class="sortbuttons" id="report_preview" data-loading-text="Please wait..">Preview</button>
	<button type="button" class="sortbuttons export_report" id="report_csv" data-loading-text="Downloading..">Export TO Excel</button>
	<button type ="button" class="sortbuttons" id="print_button" data-loading-text="Fetching Data For Print..">Print</button>
 	
 	
 	</b></p>
</td>
    </tr>    
  </table>
  </td>
  </tr>
  </table>

<div id="panel_body"  style="display: none;background-color: white;padding:50px;">
					<a href="#" id="show_filters" style="display: none;text-decoration: underline;float: right;">Show Filter Options</a>	
					<h3 style="padding-left: 450px;" align="left"> Daily Transactional Journal</h3>
					<p  style="padding-left: 485px;" align="left" id="report_dates_text"></p>
					<p align="right" id="total_pages_show_text"></p>
					<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
						<div class=" table-responsive">
						
						<table
							class="table table-striped" id="table_data">
							<thead>
								<tr bgcolor="#708090">
								   <th class="col-xs-3">Store Nbr</th>
								   <th class="col-xs-3">Drawer Nbr</th>
								   <th class="col-xs-3">Date and Time</th>
								   <th class="col-xs-3">Customer Nbr</th>
								   <th class="col-xs-3">Customer Name</th>
								   <th class="col-xs-3">Loan Nbr</th>
								   <th class="col-xs-3">Tran Nbr</th>
								   <th class="col-xs-3">Check Nbr</td>
								   <th class="col-xs-3">Issuing Check Amt</th>
								   <th class="col-xs-3">Tran Amt</th>
								   <th class="col-xs-3">Principal Amt</th>
								   <th class="col-xs-3">Fee Amt</th>
								   <th class="col-xs-3">Interest Amt</th>
								   <th class="col-xs-3">NSF Fee Amt</th>
								   <th class="col-xs-3">Orig Fee Amt</th>
								   <th class="col-xs-3">Late Fee Amt</th>
								   <th class="col-xs-3">Other Fee Amt</th>
								   <th class="col-xs-3">Waive Fee Amt</th>
								   <th class="col-xs-3">Lien Fee Amt</th>
								   <th class="col-xs-3">Waive Lien Fee Amt</th>
								   <th class="col-xs-3">Repo Fee Amt</th>
								   <th class="col-xs-3">Sale Fee Amt</th>
								   <th class="col-xs-3">Cash Amt</th>
								   <th class="col-xs-3">Check Amt</th>
								   <th class="col-xs-3">CC/MO Amt</th>
								   <th class="col-xs-3">Debit Card Amt</th>
								   <th class="col-xs-3">ACH Amt</th>
								   <th class="col-xs-3">Prepaid Card</th>
								   <th class="col-xs-3">RCC amt</th>
								   <th class="col-xs-3">Emp Nbr</th>
								   <th class="col-xs-3">Emp Name</th>
								   <th class="col-xs-3">Loan Type</th>
								   <th class="col-xs-3">Void Flag</th>
								   <th class="col-xs-3">Collateral Type</th>
								    <th class="col-xs-3">Orig Store Nbr</th>
								   <th class="col-xs-3">Payment Plan Fee</th>
								   <th class="col-xs-3">MHC Fee Amt</th>
								</tr>
							</thead>

							<tbody id="trans_body">

							</tbody>
						</table>
						</div>
						<div id="panel_footer" style="display: none;float: center;">
						<div class="row">

							<div class="col-md-12">
							<div style="float: right;">
									<ul class="pagination pagination-sm"></ul>
								</div></div>
						</div>
					</div>
					</div>
						<div class="row">
	<div id="myModal" class="modal fade">
  	<div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Print Report Details</h4>
      </div>
      <div class="modal-body" style="max-height: 350px;overflow: auto;width: auto;" id="print_column_list">
        <p>Please select the columns to print.</p>
        
            <div class="col-md-3">
       				  <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="STORE" checked="checked">Store Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="DRAWER_CODE" checked="checked">Drawer Nbr</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="DTTRANDATE" checked="checked">Date and Time</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CUSTNBR" checked="checked">Customer Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="NAME" checked="checked">Customer Name</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="LC_CODE" checked="checked">Loan Nbr</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="TRANSACTION_NUMBER" checked="checked">Tran Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="BO_CHECK_NUM" checked="checked">Check Nbr</label></div>
							 
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ISSUING_CHECK_AMOUNT" checked="checked">Issuing Check Amt</label></div>
							    
							      </div>
							   <div class="col-md-3">
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="TRAN_AMT" checked="checked">Tran Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="PRINCIPAL" checked="checked">Principal Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="FEES" checked="checked">Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="INTERESTFEE">Interest Amt</label></div>
							 
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="NSFAMT">NSF Fee Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ORIG_FEE">Orig Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="LATE_FEE_CHARGED">Late Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="OTHER_FEE">Other Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="WAIVED_FEE_AMT">Waive Fee Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="LIEN_FEE">Lien Fee Amt</label></div>
							     </div>
							   <div class="col-md-3">
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="WAIVE_LIEN_FEE">Waive Lien Fee Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="REPO_FEE">Repo Fee Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="SALE_FEE">Sale Fee Amt</label></div>
							  
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CASHAMT">Cash Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CHECKAMT">Check Amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="CCMOAMT">CC/MO Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="DEBITCARDAMT">Debit Card Amt</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ACH_AMT">ACH Amt</label></div>
							   <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="PREPAIDCARD_AMT">Prepaid Card</label></div>
							     </div>
							    <div class="col-md-3">
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="RCC_FEE">RCC amt</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="EMP_NUMBER">Emp Nbr</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="EMPNAME">Emp Name</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="TYPE">Loan Type</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="VOID_FLAG">Void Flag</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="COLLATERAL_TYPE">Collateral Type</label></div>
							      <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="ORIG_STORE_NUMBER">Orig Store Nbr</label></div>
							     <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="PPF_FEE">Payment Plan Fee</label></div>
							    <div class="checkbox">
	      <label><input type="checkbox" name="column_name" value="MHC_FEE">MHC Fee Amt</label></div>
								</div>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" id="table_print_full">Print</button>
      </div>
    </div>

  </div>
</div>		
		</div>	
		<input type="hidden" name="data_file" id="data_file"/>			
</body>
<!-- <object viewastext style="display:none"
    classid="clsid:5445be81-b796-11d2-b931-002018654e2e"
    codebase="/print/smsx.cab#Version=8,2,1,2">
        <param name="GUID" value="{370000ed-d40c-43d4-b3d3-f2e7d2eff47d}">
        <param name="Path" value="/print/sxlic.mlf">
        <param name="Revision" value="0">
</object>
 
MeadCo ScriptX
<object id="factory" viewastext style="display:none"
    classid="clsid:1663ed61-23eb-11d2-b92f-008048fdd814">
</object> -->
<script	type="text/javascript" src="webjars/jquery/2.2.4/jquery.min.js"></script>
<script	type="text/javascript" src="webjars/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script	type="text/javascript" src="webjars/bootstrap-datepicker/1.6.1/js/bootstrap-datepicker.min.js"></script>
<script src="/js/jquery.twbsPagination.js"></script>
<script src="/js/jstorage.min.js"></script>


<script type="text/javascript">

$(document).ready( function () {
	 var totalPages;
	$('#begin_date').datepicker({ 
		changeMonth: true,
	    changeYear: true,
		format:'mm/dd/yyyy',
		endDate:new Date(),
		autoclose:true
		
	}).on('changeDate',function(selected){
		var minDate = new Date(selected.date);
		$('#end_date').datepicker('setStartDate', minDate);
	});
	$('#end_date').datepicker({
		changeMonth: true,
	    changeYear: true,
		format:'mm/dd/yyyy',
		endDate:new Date(),
		autoclose:true
	});
	
	

	function validateFilters(){
		if($('#begin_date').val().length ==0 || $('#end_date').val().length ==0)
		{
			alert('Please select date range to preview data');
			return false;
		}else
			{
			return true;
			}
	}
	$("#report_preview").click(function(){
		
		if(validateFilters()){
			//clear browser enabled storage for the first time when the user changes the filter input
			$.jStorage.flush();
			//load transactions into html table by using ajax call
		  loadTransactions(1);
			//show table 
		  $("#panel_body,#panel_footer").css('display','block');
			$("#filter_options").css('display','none');
			$('#report_dates_text').html("From "+$('#begin_date').val()+" to "+$('#end_date').val());
			$("body").css("cursor", "progress");
		}
		  
	});
	function buildPagination(totlaPages){
		//destroys if any pagination is already added to DOM
		$('.pagination').twbsPagination('destroy');
		//create pagination by taking total pages as input and keeping 1000 records per page
 	$('.pagination').twbsPagination({
 		
		totalPages: totlaPages,
		// the current page that show on start
		startPage: 1,

		// maximum visible pages
		visiblePages: 5,

		initiateStartPageClick: false,

		// template for pagination links
		href: false,

		// variable name in href template for page number
		hrefVariable: '{{number}}',

		// Text labels
		first: 'first',
		prev: 'prev',
		next: 'next',
		last: 'last	',

		// carousel-style pagination
		loop: false,

		// callback function
		onPageClick: function (event, page) {
		
			
		  loadTransactions($("li[class='page active'] a").text());
		 
		},

		// pagination Classes
		paginationClass: 'pagination',
		nextClass: 'next',
		prevClass: 'prev',
		lastClass: 'last',
		firstClass: 'first',
		pageClass: 'page',
		activeClass: 'active',
		disabledClass: 'disabled'

		});
}
	
	//loads the filtered transactions by using a API service URL or from chache
	function loadTransactions(pageNumber) {
	      var tr;
	      var limit=1000;
	      var totalCountFlag='N';
	      var offset=(pageNumber*limit)-limit; 
	      var totalRecords;
	     
	      //check whether the requested transactions are available in jstorage cache or not
	      var cachedData=$.jStorage.get(pageNumber);
	       if(cachedData){
	    	   //if the cache is available then load from there
	    	  $('#trans_body').html('');
	    	  $('#trans_body').html(buildTableData(cachedData));
	    	 	$('#total_pages_show_text').html(pageNumber+" of "+totalPages+" pages");
		  }else{
		  //if data not there in cache get from DB
		  //turn on total records count flag if the page number is 1 to get the total records from DB for pagination
			 if(pageNumber==1){
				 $("#data_file").val('');
				  totalCountFlag='Y';
			 }
	      $.ajax({
	    	  	type:'POST',
				url:"/getTransJournal",
				data:JSON.stringify( {'level':$("#level").val(),
					  'transType':$("#trans_type").val(),
					  'beginDate':$("#begin_date").val(),
					  'endDate':$("#end_date").val(),
					  'limit':limit,
					  'offset':offset,
					  'totalCountFlag':totalCountFlag,
					  'sortOrder':$("#sort_order").val(),
					  'sortColumn':$("#sort_column").val(),
					  'transDataFileName':$("#data_file").val()
					}),
				dataType:'json',
				contentType:'application/json',
				cache:false,
			    beforeSend:function(xhr){
			    	xhr.setRequestHeader ("Authorization", "Basic " + btoa('user' + ":" + 'password'));
			    	 $('#trans_body').html('');
			    	 $('#trans_body').html('<p>Loading data.Please wait..</p>');
			    	 //isDataLoading=true;
			    	$("#report_preview").button('loading');
			    },
			    success:function(response){
			    
			    	//store data in cache after getting from DB
			    	$.jStorage.set(pageNumber,response.dailyTransJournals); 
			    	
			    	 $('#trans_body').html('');
			    	 $('#trans_body').html(buildTableData(response.dailyTransJournals));
			   	     
			   	
			   	if(pageNumber==1){
			   		totalRecords=response.transRecordCount;
			   	  $("#data_file").val(response.transFileName);
			   totalPages=(Math.floor(totalRecords/1000))+(totalRecords%1000>0?1:0);
			   	buildPagination(totalPages);
			   	}	
			    },
			    complete:function(){
			    	
			    	$('#total_pages_show_text').html(pageNumber+" of "+totalPages+" pages");
			    	//isDataLoading=false;
			    	$("body").css("cursor", "default");
			    		$("#report_preview").button('reset');
			    }
			});
		  }
	      
	}
	
	function buildTableData(data){
		var tableData;
	 	$.each(data, function(i,tran){
	   		
	 		tableData += "<tr>";
	   		tableData +="<td>"+tran.store+ "</td>";
	   		tableData +="<td>"+tran.drawer_code+ "</td>";
	   		tableData +="<td>"+tran.dttrandate+ "</td>";
	   		tableData +="<td>"+tran.custnbr+ "</td>";
	   		tableData +="<td>"+tran.name+ "</td>";
	   		tableData +="<td>"+tran.lc_code+ "</td>";
	   		tableData +="<td>"+tran.transaction_number+ "</td>";
	   		tableData +="<td>"+tran.bo_check_num+ "</td>";
	   		tableData +="<td>"+tran.issuing_check_amount+ "</td>";
	   		tableData +="<td>"+tran.tran_amt+ "</td>";
	   		tableData +="<td>"+tran.principal+ "</td>";
	   		tableData +="<td>"+tran.fees+ "</td>";
	   		tableData +="<td>"+tran.interestfee+ "</td>";
	   		tableData +="<td>"+tran.nsfamt+ "</td>";
	   		tableData +="<td>"+tran.orig_fee+ "</td>";
	   		tableData +="<td>"+tran.late_fee_charged+ "</td>";
	   		tableData +="<td>"+tran.other_fee+ "</td>";
	   		tableData +="<td>"+tran.waived_fee_amt+ "</td>";
	   		tableData +="<td>"+tran.lien_fee+ "</td>";
	   		tableData +="<td>"+tran.waive_lien_fee+ "</td>";
	   		tableData +="<td>"+tran.repo_fee+ "</td>";
	   		tableData +="<td>"+tran.sale_fee+ "</td>";
	   		tableData +="<td>"+tran.cashamt+ "</td>";
	   		tableData +="<td>"+tran.checkamt+ "</td>";
	   		tableData +="<td>"+tran.ccmoamt+ "</td>";
	   		tableData +="<td>"+tran.debitcardamt+ "</td>";
	   		tableData +="<td>"+tran.ach_amt+ "</td>";
	   		tableData +="<td>"+tran.prepaidcard_amt+ "</td>";
	   		tableData +="<td>"+tran.rcc_fee+ "</td>";
	   		tableData +="<td>"+tran.emp_number+ "</td>";
	   		tableData +="<td>"+tran.empname+ "</td>";
	   		tableData +="<td>"+tran.type+ "</td>";
	   		tableData +="<td>"+tran.void_flag+ "</td>";
	   		tableData +="<td>"+tran.collateral_type+ "</td>";
	   		tableData +="<td>"+tran.orig_store_number+ "</td>";
	   		tableData +="<td>"+tran.ppf_fee+ "</td>";
	   		tableData +="<td>"+tran.mhc_fee+ "</td>";
	   		tableData +="</tr>";
           
            
	    	}); 
	 	return tableData;
	}
	
	// export data into excel sheet
	$('#report_csv').click(function(){
		if(validateFilters()){
			/* var newwindow = window.open('/getTransJournalExcel?startDate='+$("#begin_date").val()+'&endDate='+$("#end_date").val()+'&level='+$("#level").val()+'&transType='+$("#trans_type").val()+'&sortOrder='+$("#sort_order").val()+'&sortColumn='+$("#sort_column").val());
			newwindow.focus();
			newwindow.onblur = function() {newwindow.close()};"; */
			var link_href='http://192.168.2.216:8084/api-auth/report/dailyTrans/getTransJournalExcel?startDate='+$("#begin_date").val()+'&endDate='+$("#end_date").val()+'&level='+$("#level").val()+'&transType='+$("#trans_type").val()+'&sortOrder='+$("#sort_order").val()+'&sortColumn='+$("#sort_column").val();
			$('body').append('<a id="link" href="'+link_href+'" target="_blank">&nbsp;</a>');
			$('#link')[0].click();
			console.log("document.cookie::"+document.cookie);
			//$('#report_csv').button('loading'); need to check this with cookie
			//checkDownloadCookie();
			
			
		}
	});
	
	
	
	
	
	//print user requested data using scriptx
	 $('#table_print_full').click(function(){
		
				 
		var columns_checked=$('#print_column_list').find('input[type="checkbox"]:checked').length;
		if(columns_checked == 12){
			var selectedColumnValues=[];
			var selectedColumnNames=[];
			$.each($("input[name='column_name']:checked"), function(){
				selectedColumnNames.push($(this).parent('label').text());
				selectedColumnValues.push($(this).val());
            });
			var html="";
			 $.ajax({
		    	  	type:'POST',
					url:"/printDTJReport",
					data:JSON.stringify( {'level':$("#level").val(),
						  'transType':$("#trans_type").val(),
						  'beginDate':$("#begin_date").val(),
						  'endDate':$("#end_date").val(),
						  'limit':0,
						  'offset':0,
						  'sortOrder':$("#sort_order").val(),
						  'sortColumn':$("#sort_column").val(),
						  'selectedColumnNames':selectedColumnNames,
						  'selectedColumnValues':selectedColumnValues
						}),
					dataType:'json',
					contentType:'application/json',
					cache:false,
				    beforeSend:function(xhr){
				    	xhr.setRequestHeader ("Authorization", "Basic " + btoa('user' + ":" + 'password'));
				    	 $('#print_button').button('loading');

				    },
				    success:function(response){
				    	console.log(response.status+':::'+response.message);
				    	alert(response.message);
				  						
				    },
				    complete:function(){
				 	 	 $('#print_button').button('reset');
				    }
				});
		return true;
		}else{
			alert("Please select at least 12 columns to print");
			return false;
		}
	}); 
	
	
	//open modal window
	 $('#print_button').click(function(){
	 
	 	 if(validateFilters()){
	 	$('#myModal').modal('show');
	 	return true
	 }else{
	 	 return false;
	 }
	 });
	  $('#myModal').modal('hide');
});



</script>
</html>